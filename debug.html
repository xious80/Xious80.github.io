<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="utf-8" />
  <title>DEBUG: D3 + TopoJSON</title>
  <script src="https://cdn.jsdelivr.net/npm/d3@7/dist/d3.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/topojson-client@3/dist/topojson-client.min.js"></script>
  <style>
    body { margin:0; }
    svg { width:100vw; height:100vh; display:block; }
    path { fill:#e0e0e0; stroke:#333; }
  </style>
</head>
<body>
  <svg></svg>
  <script>
  window.onload = () => {
    console.log("üöÄ Script startar");
    console.log("d3:", typeof d3, d3 ? "OK":"MISSING");
    console.log("topojson:", typeof topojson, topojson ? "OK":"MISSING");

    Promise.all([
      d3.json("https://cdn.jsdelivr.net/npm/world-atlas@2/countries-110m.json"),
      d3.json("https://flagcdn.com/en/codes.json")
    ])
    .then(([topo, codes]) => {
      console.log("‚úîÔ∏è TopoJSON inl√§st, objects:", Object.keys(topo.objects));
      console.log("‚úîÔ∏è Codes inl√§sta, antal:", Object.keys(codes).length);

      const features = topojson.feature(topo, topo.objects.countries).features;
      console.log("‚Üí Features (l√§nder):", features.length);

      const svg = d3.select("svg");
      const proj = d3.geoNaturalEarth1().fitSize([window.innerWidth, window.innerHeight], { type: "FeatureCollection", features });
      const path = d3.geoPath(proj);

      svg.selectAll("path")
        .data(features)
        .join("path")
          .attr("d", path);

      console.log("üèÅ Kartan borde nu synas i gr√•tt. Inte? Kolla n√§tverksfliken f√∂r 404/CORS.");
    })
    .catch(err => {
      console.error("‚ùå N√•got gick fel vid inl√§sning:", err);
    });
  };
  </script>
</body>
</html>
